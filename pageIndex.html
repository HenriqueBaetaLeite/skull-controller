<!DOCTYPE html>
<html>
  <head>
    <title>The Skull Controller</title>
    <meta name="author" content="Henrique BaÃªta" />
    <meta name="language" content="English" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        text-align: center;
      }

      .slidecontainer {
        width: 100%;
      }

      .slider:hover {
        opacity: 2;
      }

      .btn {
        border-radius: 15px;
        border: none;
        height: 25px;
        cursor: pointer;
        color: rgb(255, 255, 255);
        background-color: #8a8889;
        color: white;
      }

      .btn:hover {
        background-color: #555;
      }

    </style>
  </head>

  <body>
    <h1>The Skull Controller</h1>
    <br /><br />
    <div class="slidecontainer">
      <input
        type="range"
        min="0"
        max="180"
        value="90"
        class="slider"
        id="range-slider"
      />
      <p>Mouth angle: <span id="range-value"></span></p>
      <br /><br />

      <button type="button" onclick="setSkullNumberFunction(1)" class="btn">
        Open/Close
      </button>
      <br /><br />

      <button type="button" onclick="setSkullNumberFunction(2)" class="btn">
        Open
      </button>
      <br /><br />

      <button type="button" onclick="setSkullNumberFunction(3)" class="btn">
        Half
      </button>
      <br /><br />

      <button type="button" onclick="setSkullNumberFunction(4)" class="btn">
        Close
      </button>
    </div>

    <script>
      function sendRangeData(position) {
        const xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            console.log("Resp from server: ", this.responseText);
          }
        };
        xhttp.open("GET", "setRange?servoRange=" + position, true);
        xhttp.send();
      }

      function setSkullNumberFunction(numberOfFunction) {
        const xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            console.log("Resp from server: ", this.response);
          }
        };
        xhttp.open(
          "GET",
          "setServoFunction?setFunction=" + numberOfFunction,
          true
        );
        xhttp.send();
      }

      // Teste para saber se de fato vou trocar o XMLHttpRequest pelo fetch.

      function setFunctionFetch(numberOfFunction) {
        fetch("setServoFunction?setFunction=" + numberOfFunction)
          .then((response) => response.json())
          .then((data) => console.log("Here I go!", data));
      }
      setFunctionFetch(2);

      const slider = document.getElementById("range-slider");
      const rangeSpan = document.getElementById("range-value");

      rangeSpan.innerHTML = slider.value;

      slider.oninput = function () {
        rangeSpan.innerHTML = this.value;
        sendRangeData(rangeSpan.innerHTML);
      };
    </script>
  </body>
</html>
